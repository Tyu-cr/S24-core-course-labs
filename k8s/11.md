## Kubernetes Secrets

### Task 1

### Create Secret

```commandline
$ kubectl create secret generic test-secret --from-literal=username=admin --from-literal=password='S!B\*d$zDsb='
```

### Verify

```commandline
$ kubectl get secrets

NAME          TYPE     DATA   AGE
test-secret   Opaque   2      52s
```

```commandline
$ kubectl describe secret test-secret 

Name:         test-secret
Namespace:    default
Labels:       <none>
Annotations:  <none>

Type:  Opaque

Data
====
password:  12 bytes
username:  5 bytes
```

### Decode

```commandline
$ kubectl get secret db-user-pass -o jsonpath='{.data}'

{"password":"UyFCXCpkJHpEc2I9","username":"YWRtaW4="}
```

```commandline
$ echo 'UyFCXCpkJHpEc2I9' | base64 --decode

S!B\*d$zDsb=
```

### Helm

```commandline
$ helm secrets install app-python .\app-python\ -n default -f .\secrets.yaml

[helm-secrets] Decrypt: .\secrets.yaml
NAME: app-python
LAST DEPLOYED: Wed Apr 17 01:51:21 2024
NAMESPACE: default
STATUS: deployed
REVISION: 1
NOTES:
1. Get the application URL by running these commands:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=app-python,app.kubernetes.io/instance=app-python" -o jsonpath="{.items[0].metadata.name}")
  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath="{.spec.containers[0].ports[0].containerPort}")
  echo "Visit http://127.0.0.1:8080 to use your application"
  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT

[helm-secrets] Removed: ./secrets.yaml.dec
```

```commandline
$ kubectl get pods

NAME                          READY   STATUS    RESTARTS   AGE
app-python-6fd5cd6c67-ddnjs   1/1     Running   0          4m19s
```

```commandline
$ kubectl exec app-python-6fd5cd6c67-ddnjs -- printenv | grep MY_PASSWORD

MY_PASSWORD=secret1234
```
